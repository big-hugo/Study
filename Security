伪装登录(用于隐藏系统和内核版本)
vim /etc/issue              本地登录提示文件
vim /etc/issue.net          远程登录提示文件

文件系统安全
chkconfig  httpd  off/on    RHEL6系统服务操作命令
systemctl  enable/disable  httpd    RHEL7系统服务操作命令
锁定/解锁保护文件(root用户同样受到限制)
EXT3/EXT4的文件属性控制  属性i:不可变  属性a:仅可追加
chatte  +a   文件     设置对文件属性(+-=可用)
lsattr [-l]  文件     查看文件属性

selinux
三大保护策略:安全上下文,布尔值,端口
vim /etc/sysconfig/selinux    主配置文件
SELINUX=disabled              定义默认启用模式
SELINUXTYPE=targeted          定义默认工作模式
getenforce           查看selinux是否开启
sestatus             查看selinux状态
setenforce   1/0     开启/关闭selinux(临时)
安全上下文
移动的文件,原有安全上下文不变;新建/复制的文件,自动继承目标位置的上下文
属性构成   system_u:object_r:admin_home_t:s0      用户:角色:访问类型:选项...
ls -lZ  文件          查看安全上下文
ls -ldZ /etc         查看安全上下文
ps -aux -Z | grep 进程名       查看安全上下文
chcon -t  访问类型  [-R]  文件  修改文件上下文访问类型(-R递归)
restorecon  [-R]  文件         恢复所在位置默认上下文属性(-R递归)  
touch  /.autorelabel          创建该文件,下次重启系统全部恢复上下文属性
布尔值(功能开关)
getsebool -a          查看所有配置项布尔值
setsebool -P  配置项名称 on/off      开/关布尔值

MD5数值校验
根据输入的文件生成不同的哈希值,可通过对比哈希值检测文件是否有变化
md5sum  文件            生成哈希值

GPG加/解密工具
gpg --version           查看软件版本信息
gpg对称加密与解密
gpg -c 文件             设置密码
file  文件*              查看加密后文件(加密后会生成文件.gpg)
gpg -d  加密后文件  >  输出到文档      解密文档(不同用户需要输入密码)
gpg非对称加密与解密
(mv /dev/random /dev/random.bak    如果启动不了或过慢
ln -s /dev/urandom /dev/random    执行这两部操作进行内存调整)
gpg --gen-key           创建秘钥对(秘钥对存放在~/.gnupg/)
gpg --list-keys         查看秘钥信息
gpg --export -a  >  用户名.pub       生成公钥文件(发送给目标用户)
gpg --import 用户名.pub              导入公钥文件
gpg -e -r 公钥用户名   文件           用公钥给文件加密(生成文件.gpg)
gpg -d  加密文件         解密文档(输入公钥设置的密码)
gpg数字签名与验证签名(私钥文件签名 公钥文件验证签名)
gpg -b 文件              给文件作签名(生成文件.sig)
gpg --import 用户名.pub              导入公钥文件
gpg --verify  文件       检验签名(没修改会提示完好签名)

AIDE入侵检测系统
yum -y install aide     安装软件包
vim /etc/aide.conf      主配置文件 
3 @@define DBDIR /var/lib/aide            数据库目录
4 @@define LOGDIR /var/log/aide           日志目录
7 database=file:@@{DBDIR}/aide.db.gz      数据库文件名
54 FIPSR = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha256   检测的策略名=检测项目
98 /root/    FIPSR     用FIPSR检测策略检测root目录
aide --init             初始化检测(记录当前系统检测情况)
mv  /var/lib/aide/aide.db.new.gz  /var/lib/aide/aide.db.gz  数据备份(一般备份到移动设备)
aide --check            检测对比信息(与初始化检测的文件作对比)

日志管理
由系统服务rsyslog统一管理和记录,日志消息等级0~7,数值越小越紧急
/var/log/messages     记录内核,各种服务           /var/log/maillog      记录邮件收发
/var/log/dmesg        记录系统启动过程            /var/log/secure       记录访问限制相关
/var/log/cron         记录cron计划任务
user      查看已登录用户信息
who       查看已登录用户信息
w         查看已登录用户信息
last      查看登录成功用户记录
lastb     查看登录失败用户记录

扫描与抓包
主流扫描软件:Scan主动监测,Sniff被动监听/嗅探,Capture数据包捕获(抓包),NMAP强大的网络探测利器工具
NMAP扫描软件
用法格式:   nmap  [扫描类型]  [选项]  扫描目标...
扫描类型:  -sS TCP-SYN扫描(半开,DDOS攻击原理)    -sT  TCP连接扫描(全开,默认)   -sU  UDP扫描   -sP  ICMP扫描  -A 目标系统全面解析
选项:     -p 扫描指定端口     -n 不执行dns扫描(速度更快)
yum -y install nmap       安装软件
nmap -p 21-80   192.168.4.0/24     扫描4网段的主机指定端口
nmap -n 192.168.4.0/24    扫描4网段有多少主机开启
nmap www.baidu.com        扫描百度的服务端口
tcpdump抓包命令
yum -y install tcpdump    安装软件
用法格式: tcpdump   [选项]   [过滤条件]
选项: -i 指定监控的网络接口  -A 转为ACSII码方便阅读  -w 将数据包信息保存到指定文件  -c 定义抓包个数  -r 从指定文件读取数据包信息
过滤条件: 类型host net port portrange  方向src dst  协议tcp udp ip wlan arp  多个条件组合and or not
tcpdump -i  网卡名称       指定网卡抓包
tcpdump -c 2 -w x.cap     抓两个包保存到x.cap文件
tcpdump -r x.cap          读取x.cap文件
tcpdump -i eth0 -A tcp port 22 and host 172.121.213.105 or host 172.121.213.111     查看是否有来自该IP的连接
tcpdump -A dst host 192.168.4.5 and tcp port 110          按条件抓取POP3的数据包(可查看账号密码)
tcpdump  -A  -w ftp.cap host 192.168.4.254 and port 21    把来自254接收端口21的包信息保存到ftp.cap
tcpdump  -A -r ftp.cap | egrep '(USER|PASS)'    过滤抓到包的用户信息
WireShark图形环境抓包软件
yum -y install wireshark wireshark-gnome    安装软件包
wireshark       运行软件



















